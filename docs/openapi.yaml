openapi: 3.0.4

info:
  title: School Management API
  version: 1.0.0
  description: >-
    **Português:**
    API para gestão de sistemas educacionais, permitindo controle de usuários,
    alunos, professores, turmas e relatórios.

    **English:**
    API for managing educational systems, enabling control of users,
    students, teachers, classes, and reports.
  contact:
    name: Gabriel Vitor Siqueira
    url: https://github.com/gabrielvsiqueira/school-management-api

servers:
  - url: http://localhost:8000
    description: Servidor de Desenvolvimento Local (Laravel)
  - url: https://api.school-management.com/v1
    description: Servidor de Produção

tags:
  - name: Auth Token
    description: Rotas de autenticação.
  - name: Students
    description: Gestão de alunos.
  - name: Teachers
    description: Gestão de professores.
  - name: ClassModel
    description: Gestão de turmas.

paths:
  ################################
  # AUTH
  ################################
  /api/register:
    post:
      tags: [Auth Token]
      summary: Registra um novo usuário e retorna um token.
      requestBody:
        required: true
        content:
          application/json:
            example:
              name: "Alan Turing"
              email: "turing@teste.com"
              password: "1234567"
              password_confirmation: "1234567"
              department: "Ciência da Computação"
      responses:
        '201':
          description: Usuário criado com sucesso.
          content:
            application/json:
              example:
                user:
                  id: 1
                  name: "Gabriel Siqueira"
                  email: "gabriel@example.com"
                token: "2|token_exemplo"

  /api/login:
    post:
      tags: [Auth Token]
      summary: Realiza login e retorna um Bearer Token.
      requestBody:
        required: true
        content:
          application/json:
            example:
              email: "turing@teste.com"
              password: "1234567"
      responses:
        '200':
          description: Login realizado com sucesso.
          content:
            application/json:
              example:
                status: "success"
                token: "6|token_exemplo"
        '401':
          description: Credenciais inválidas.

  ################################
  # STUDENTS CRUD
  ################################
  /api/students:
    get:
      tags: [Students]
      summary: Lista todos os alunos.
      responses:
        '200':
          description: Lista de alunos.
          content:
            application/json:
              example: { }

    post:
      tags: [Students]
      summary: Cadastra um novo aluno.
      requestBody:
        required: true
        content:
          application/json:
            example:
              name: "Maria Oliveira"
              date_of_birth: "2007-09-21"
              turma_id: 5
      responses:
        '201':
          description: Aluno criado com sucesso.

  /api/students/{studentId}:
    patch:
      tags: [Students]
      summary: Atualiza um aluno.
      parameters:
        - name: studentId
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            example:
              name: "João Silva Atualizado"
      responses:
        '200':
          description: Aluno atualizado.

    delete:
      tags: [Students]
      summary: Remove um aluno.
      parameters:
        - name: studentId
          in: path
          required: true
          schema:
            type: integer
      responses:
        '204':
          description: Aluno removido.

  ################################
  # TEACHERS CRUD
  ################################
  /api/teachers:
    get:
      tags: [Teachers]
      summary: Lista todos os professores.
      responses:
        '200':
          description: Lista de professores.

    post:
      tags: [Teachers]
      summary: Cria um novo professor.
      requestBody:
        required: true
        content:
          application/json:
            example:
              name: "Carlos Lima"
              email: "carlos@example.com"
              specialization: "História"
      responses:
        '201':
          description: Professor criado.

  /api/teachers/{teacherId}:
    get:
      tags: [Teachers]
      summary: Busca professor por ID.
      parameters:
        - name: teacherId
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Professor encontrado.

    patch:
      tags: [Teachers]
      summary: Atualiza professor.
      parameters:
        - name: teacherId
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            example:
              specialization: "Geografia"
      responses:
        '200':
          description: Professor atualizado.

    delete:
      tags: [Teachers]
      summary: Remove professor.
      parameters:
        - name: teacherId
          in: path
          required: true
          schema:
            type: integer
      responses:
        '204':
          description: Professor removido.

  ################################
  # CLASS MODELS CRUD
  ################################
  /api/class-models:
    get:
      tags: [ClassModel]
      summary: Lista todas as turmas.
      responses:
        '200':
          description: Lista de turmas.

    post:
      tags: [ClassModel]
      summary: Cria uma nova turma.
      requestBody:
        required: true
        content:
          application/json:
            example:
              name: "Turma B"
              subject: "Matemática"
              teacher_id: 2
      responses:
        '201':
          description: Turma criada.

  /api/class-models/{classModelId}:
    get:
      tags: [ClassModel]
      summary: Detalhes da turma.
      parameters:
        - name: classModelId
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Turma encontrada.

    patch:
      tags: [ClassModel]
      summary: Atualiza turma.
      parameters:
        - name: classModelId
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            example:
              subject: "Química"
      responses:
        '200':
          description: Turma atualizada.

    delete:
      tags: [ClassModel]
      summary: Remove turma.
      parameters:
        - name: classModelId
          in: path
          required: true
          schema:
            type: integer
      responses:
        '204':
          description: Turma removida.

  /api/class-models/{classModelId}/teacher:
    post:
      tags: [ClassModel]
      summary: Define professor responsável pela turma.
      parameters:
        - name: classModelId
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            example:
              teacher_id: 5
      responses:
        '200':
          description: Professor vinculado.

components:
  schemas:
    Student:
      type: object
      properties:
        id: { type: integer }
        name: { type: string }
        email: { type: string }
        date_of_birth: { type: string, format: date }

    Teacher:
      type: object
      properties:
        id: { type: integer }
        name: { type: string }
        email: { type: string }
        specialization: { type: string }

    ClassModel:
      type: object
      properties:
        id: { type: integer }
        name: { type: string }
        subject: { type: string }
        teacher_id: { type: integer }
